{% extends 'base.html' %}

{% block content %}
  <h1>Movies</h1>
  <div class="row row-cols-1 row-cols-md-5 g-4">
    {% for movie in page_obj %}
      <div class="col">
        <div class="card h-100">
          <img src="{{ movie.poster_path }}" class="card-img-top">
          <a href="{% url 'movies:detail' movie.pk %}" class="text-decoration-none text-dark">
            <div class="card-body">
              <h5 class="card-title">{{ movie.title }}</h5>

              <p>
                {% for genre in movie.genres.all %}
                  <span>{{ genre.name }}</span>
                {% endfor %}
              </p>

              {% if movie.overview %}
                <p class="card-text">{{ movie.overview|truncatechars:60 }}</p>
              {% else %}
                <p class="card-text">줄거리 없음</p>
              {% endif %}
            </div>
          </a>
        </div>
      </div>
    {% endfor %}
  </div>

  <div class="d-flex justify-content-center">
    <ul class="pagination step-links page-item">
      {% if page_obj.has_previous %}
        <li><a class="page-link" href="?page=1">&laquo; first</a></li>
        <li><a class="page-link" href="?page={{ page_obj.previous_page_number }}">previous</a></li>
      {% else %}
        <li class="page-item disabled"><a class="page-link" href="#">&laquo; first</a></li>
        <li class="page-item disabled"><a class="page-link" href="#">previous</a></li>
      {% endif %}

      {% for num in page_obj.paginator.page_range %}
        {% if num == page_obj.number %}
          <li class="page-item active"><a class="page-link" href="?page={{ num }}">{{ num }}</a></li>
        {% else %}
          <li class="page-item"><a class="page-link" href="?page={{ num }}">{{ num }}</a></li>
        {% endif %}
      {% endfor %}

      {% if page_obj.has_next %}
        <li><a class="page-link" href="?page={{ page_obj.next_page_number }}">next</a></li>
        <li><a class="page-link" href="?page={{ page_obj.paginator.num_pages }}">last &raquo;</a></li>
      {% else %}
        <li class="page-item disabled"><a class="page-link" href="#">next</a></li>
        <li class="page-item disabled"><a class="page-link" href="#">last &raquo;</a></li>
      {% endif %}
    </ul>
  </div>
{% endblock %}
